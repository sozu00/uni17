(function(A){A.fn.galleryView=function(D){var O=A.extend(A.fn.galleryView.defaults,D);O.panel_width=A(".panel").width();O.panel_height=A(".panel").height();if(A(".filmstrip li img").length){O.frame_width=A(".filmstrip li img").width();O.frame_height=A(".filmstrip li img").height()}else{O.frame_width=A(".filmstrip li div").width();O.frame_height=A(".filmstrip li div").height()}var d=navigator.userAgent.toLowerCase();jQuery.browser={version:(d.match(/.+(?:rv|it|ra|ie|me)[\/: ]([\d.]+)/)||[])[1],chrome:/chrome/.test(d),safari:/webkit/.test(d)&&!/chrome/.test(d),opera:/opera/.test(d),msie:/msie/.test(d)&&!/opera/.test(d),mozilla:/mozilla/.test(d)&&!/(compatible|webkit)/.test(d)};if(A.browser.msie){if(A.browser.version<=6){O.fade_panels=false}}var S;var R=0;var I;var U;var K=10;var F;var b;var N=0;var e;var V;var a=false;var Z=20;var P=5;var E=0;var c;var W;var Y;var L;var Q;function J(f){A("img.nav-next").unbind("click");A("img.nav-prev").unbind("click");Y.unbind("click");if(has_panels){if(O.fade_panels){L.fadeOut(O.transition_speed).eq(f%N).fadeIn(O.transition_speed,function(){if(!has_filmstrip){A("img.nav-prev").click(C);A("img.nav-next").click(T)}})}}if(has_filmstrip){if(e=="strip"){W.stop();var j=X(Y[f]).left-(X(Q[0]).left+E);var g=(j>=0?"-=":"+=")+Math.abs(j)+"px";W.animate({left:g},O.transition_speed,O.easing,function(){if(f>N){f=f%N;R=f;W.css("left","-"+((O.frame_width+K)*f)+"px")}else{if(f<=(N-strip_size)){f=(f%N)+N;R=f;W.css("left","-"+((O.frame_width+K)*f)+"px")}}if(!O.fade_panels){L.hide().eq(f%N).show()}A("img.nav-prev").click(C);A("img.nav-next").click(T);M()})}else{if(e=="pointer"){Q.stop();var h=X(Y[f]);Q.animate({left:(h.left-E+"px")},O.transition_speed,O.easing,function(){if(!O.fade_panels){L.hide().eq(f%N).show()}A("img.nav-prev").click(C);A("img.nav-next").click(T);M()})}}if(A("a",Y[f])[0]){Q.unbind("click").click(function(){var i=A("a",Y[f]).eq(0);if(i.attr("target")=="_blank"){window.open(i.attr("href"))}else{location.href=i.attr("href")}})}}}function T(){A(document).stopTime("transition");if(++R==Y.length){R=0}J(R);A(document).everyTime(O.transition_interval,"transition",function(){T()})}function C(){A(document).stopTime("transition");if(--R<0){R=N-1}J(R);A(document).everyTime(O.transition_interval,"transition",function(){T()})}function X(i){var l=0,k=0;var f=i.id;if(i.offsetParent){do{l+=i.offsetLeft;k+=i.offsetTop}while(i=i.offsetParent)}if(f==S){return{left:l,top:k}}else{var h=X(c[0]);var j=h.left;var g=h.top;return{left:l-j,top:k-g}}}function M(){Y.each(function(f){if(A("a",this).length==0){A(this).click(function(){A(document).stopTime("transition");J(f);R=f;A(document).everyTime(O.transition_interval,"transition",function(){T()})})}})}function H(){if(!has_filmstrip&&!A(".nav-next").length){A("<img />").addClass("nav-next").attr("src",V+O.nav_theme+"/next.gif").appendTo(c).css({right:"10px",display:"none"}).click(T);A("<img />").addClass("nav-prev").attr("src",V+O.nav_theme+"/prev.gif").appendTo(c).css({left:"10px",display:"none"}).click(C);A("<img />").addClass("nav-overlay").attr("src",V+O.nav_theme+"/panel-nav-next.gif").appendTo(c).css({position:"absolute",zIndex:"1099",top:((O.panel_height-O.anchoBotones)/2)-10+"px",right:"0",display:"none"});A("<img />").addClass("nav-overlay").attr("src",V+O.nav_theme+"/panel-nav-prev.gif").appendTo(c).css({position:"absolute",zIndex:"1099",top:((O.panel_height-O.anchoBotones)/2)-10+"px",left:"0",display:"none"})}L.css({width:(O.panel_width-parseInt(L.css("paddingLeft").split("px")[0],10)-parseInt(L.css("paddingRight").split("px")[0],10))+"px",height:(O.panel_height-parseInt(L.css("paddingTop").split("px")[0],10)-parseInt(L.css("paddingBottom").split("px")[0],10))+"px",position:"absolute",top:(O.filmstrip_position=="top"?(O.frame_height+P+(O.show_captions?Z:P))+"px":"0px"),left:"0px",overflow:"hidden",background:"white",display:"none"})}function G(){if(!A(".strip_wrapper").length){W.wrap('<div class="strip_wrapper"></div>');if(e=="strip"){Y.clone().appendTo(W);Y.clone().appendTo(W);Y=A("li",W)}if(O.show_captions){Y.append('<div class="caption"></div>').each(function(h){A(this).find(".caption").html(A(this).find("img").attr("title"))})}}W.css({width:F+"px",visibility:"visible"});A(".strip_wrapper",c).css({width:b+"px"});switch(O.posicion_navegacion){case"left":A(".strip_wrapper",c).css({left:O.anchoBotones+(K*2)+"px"});break;case"right":A(".strip_wrapper",c).css({right:O.anchoBotones+(K*2)+"px"});break;case"center":A(".strip_wrapper",c).css({left:((I-b)/2)+"px"});break}var g=A("<div></div>");if(!A("#pointer").length){g.attr("id","pointer").appendTo(c).css({left:X(Y[0]).left-(E/2)+"px",width:O.frame_width-E-2+"px"})}Q=A("#pointer",c);if(!A("#pointer img").length){if(has_panels){var f=A("<img />");f.attr("src",V+O.nav_theme+"/pointer.gif").appendTo(A("#pointer"))}}if(e=="strip"){W.css("left","-"+((O.frame_width+K)*N)+"px");R=N}if(A("a",Y[R])[0]){Q.click(function(){var h=A("a",Y[R]).eq(0);if(h.attr("target")=="_blank"){window.open(h.attr("href"))}else{location.href=h.attr("href")}})}if(!A(".nav-next").length){A("<img />").addClass("nav-next").attr("src",V+O.nav_theme+"/next.gif").appendTo(c).click(T);switch(O.posicion_navegacion){case"left":A(".nav-next").css({left:b+O.anchoBotones+(3*K)+"px"});break;case"right":A(".nav-next").css({right:K+"px"});break;case"center":A(".nav-next").css({right:(I/2)-(b/2)-10-O.anchoBotones+"px"});break}}if(!A(".nav-prev").length){A("<img />").addClass("nav-prev").attr("src",V+O.nav_theme+"/prev.gif").appendTo(c).click(C);switch(O.posicion_navegacion){case"left":A(".nav-prev").css({left:K+"px"});break;case"right":A(".nav-prev").css({right:b+O.anchoBotones+(3*K)+"px"});break;case"center":A(".nav-prev").css({left:(I/2)-(b/2)-10-O.anchoBotones+"px"});break}}}function B(f,j){var i=X(c[0]);var h=i.top;var g=i.left;return f>g&&f<g+O.panel_width&&j>h&&j<h+O.panel_height}return this.each(function(){c=A(this);A("script").each(function(f){var g=A(this);if(g.attr("src")&&g.attr("src").match(/jquery\.galleryview/)){V=g.attr("src").split("jquery.galleryview")[0]+"themes/"}});c.css("visibility","hidden");W=A(".filmstrip",c);Y=A("li",W);L=A(".panel",c);S=c.attr("id");has_panels=L.length>0;has_filmstrip=Y.length>0;if(!has_panels){O.panel_height=0}N=has_panels?L.length:Y.length;strip_size=has_panels?Math.floor(((O.panel_width*O.tam_navegacion)-64)/(O.frame_width+K)):Math.min(N,O.filmstrip_size);if(strip_size>=N){e="pointer";strip_size=N}else{e="strip"}I=has_panels?O.panel_width:(strip_size*(O.frame_width+K))-K+64;U=(has_panels?O.panel_height:0)+(has_filmstrip?O.frame_height+P+(O.show_captions?Z:P):0);if(e=="pointer"){F=(O.frame_width*N)+(K*(N))}else{F=(O.frame_width*N*3)+(K*(N*3))}b=((strip_size*O.frame_width)+((strip_size-1)*K));if(has_filmstrip){G()}if(has_panels){H()}if(has_filmstrip){M()}A().mousemove(function(f){if(B(f.pageX,f.pageY)){if(O.pause_on_hover){A(document).oneTime(500,"animation_pause",function(){A(document).stopTime("transition");a=true})}if(has_panels&&!has_filmstrip){A(".nav-overlay").fadeIn("fast");A(".nav-next").fadeIn("fast");A(".nav-prev").fadeIn("fast")}}else{if(O.pause_on_hover){A(document).stopTime("animation_pause");if(a){A(document).everyTime(O.transition_interval,"transition",function(){T()});a=false}}if(has_panels&&!has_filmstrip){A(".nav-overlay").fadeOut("fast");A(".nav-next").fadeOut("fast");A(".nav-prev").fadeOut("fast")}}});L.eq(0).show();if(N>1){A(document).everyTime(O.transition_interval,"transition",function(){T()})}c.css("visibility","visible")})};A.fn.galleryView.defaults={filmstrip_size:3,transition_speed:400,transition_interval:3000,anchoBotones:24,nav_theme:"dark",posicion_navegacion:"center",tam_navegacion:0.5,easing:"swing",show_captions:false,fade_panels:true,pause_on_hover:true}})(jQuery);